<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Strategies implementing uncertainty models | Spatio-Temporal Methods in Environmental Epidemiology with R</title>
  <meta name="description" content="Chapter 7 Strategies implementing uncertainty models | Spatio-Temporal Methods in Environmental Epidemiology with R" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Strategies implementing uncertainty models | Spatio-Temporal Methods in Environmental Epidemiology with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/img/cover.jpg" />
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Strategies implementing uncertainty models | Spatio-Temporal Methods in Environmental Epidemiology with R" />
  
  
  <meta name="twitter:image" content="/img/cover.jpg" />

<meta name="author" content="Gavin Shaddick, James V. Zidek, and Alexandra M. Schmidt" />


<meta name="date" content="2023-07-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="tactics.html"/>
<link rel="next" href="trusted.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatio-temporal methods in environmental epidemiology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="why.html"><a href="why.html"><i class="fa fa-check"></i><b>1</b> Why spatio-temporal epidemiology?</a></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Epidemiology-the basics</a>
<ul>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#example-2.7-estimating-the-smr-using-a-poisson-glm"><i class="fa fa-check"></i>Example 2.7: Estimating the SMR using a Poisson GLM</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#example-2.8-estimating-the-smr-using-quasi-likelihood"><i class="fa fa-check"></i>Example 2.8: Estimating the SMR using quasi-likelihood</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#example-2.9-modelling-differences-in-smrs-in-relation-to-differences-in-exposures"><i class="fa fa-check"></i>Example 2.9: Modelling differences in SMRs in relation to differences in exposures</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#example-2.10-modelling-the-risks-associated-with-lagged-effects-of-air-pollution"><i class="fa fa-check"></i>Example 2.10: Modelling the risks associated with lagged effects of air pollution</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#example-2.10-estimating-the-odds-ratio-in-a-case-control-study-using-a-logistic-model"><i class="fa fa-check"></i>Example 2.10: Estimating the odds ratio in a case-control study using a logistic model</a></li>
<li class="chapter" data-level="" data-path="basics.html"><a href="basics.html#example-2.11-estimating-the-odds-ratio-of-asthma-associated-with-proximity-to-roads"><i class="fa fa-check"></i>Example 2.11: Estimating the odds ratio of asthma associated with proximity to roads</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>3</b> Uncertainty and its reduction</a>
<ul>
<li class="chapter" data-level="" data-path="uncertainty.html"><a href="uncertainty.html#supplementary-material"><i class="fa fa-check"></i>Supplementary Material</a>
<ul>
<li class="chapter" data-level="" data-path="uncertainty.html"><a href="uncertainty.html#more-on-qualitative-uncertainty"><i class="fa fa-check"></i>More on qualitative uncertainty</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data: increasing information and reducing uncertainty</a>
<ul>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#getting-to-know-the-structure-of-dataframes"><i class="fa fa-check"></i>Getting to know the structure of dataframes</a></li>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#extracting-and-creating-variables"><i class="fa fa-check"></i>Extracting and creating variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="embracing.html"><a href="embracing.html"><i class="fa fa-check"></i><b>5</b> Embracing uncertainty: the Bayesian approach</a></li>
<li class="chapter" data-level="6" data-path="tactics.html"><a href="tactics.html"><i class="fa fa-check"></i><b>6</b> Tactics-implementing uncertainty models</a>
<ul>
<li class="chapter" data-level="" data-path="tactics.html"><a href="tactics.html#example-6.2-chronic-obstructive-pulmonary-disease-copd-in-england"><i class="fa fa-check"></i>Example 6.2: Chronic obstructive pulmonary disease (COPD) in England</a>
<ul>
<li class="chapter" data-level="" data-path="tactics.html"><a href="tactics.html#modelling-the-raw-standardized-mortality-rates-smrs"><i class="fa fa-check"></i>Modelling the raw standardized mortality rates (SMRs)</a></li>
<li class="chapter" data-level="" data-path="tactics.html"><a href="tactics.html#modelling-a-poisson-gamma-with-an-mcmc-implemented-in-r"><i class="fa fa-check"></i>Modelling a Poisson-Gamma with an MCMC implemented in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tactics.html"><a href="tactics.html#example-6.3-fitting-a-poisson-regression-model"><i class="fa fa-check"></i>Example 6.3: Fitting a Poisson regression model</a>
<ul>
<li class="chapter" data-level="" data-path="tactics.html"><a href="tactics.html#nimble"><i class="fa fa-check"></i>Nimble</a></li>
<li class="chapter" data-level="" data-path="tactics.html"><a href="tactics.html#stan"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Strategies.html"><a href="Strategies.html"><i class="fa fa-check"></i><b>7</b> Strategies implementing uncertainty models</a>
<ul>
<li class="chapter" data-level="" data-path="Strategies.html"><a href="Strategies.html#example-7.6-model-choice-in-studies-of-air-pollution-and-health"><i class="fa fa-check"></i>Example 7.6 Model choice in studies of air pollution and health</a>
<ul>
<li class="chapter" data-level="" data-path="Strategies.html"><a href="Strategies.html#nimble-1"><i class="fa fa-check"></i>Nimble</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="trusted.html"><a href="trusted.html"><i class="fa fa-check"></i><b>8</b> But can the data be trusted</a>
<ul>
<li class="chapter" data-level="" data-path="trusted.html"><a href="trusted.html#solutions-to-selected-exercises"><i class="fa fa-check"></i>Solutions to Selected Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="trusted.html"><a href="trusted.html#placeholder-repeat-the-black-smoke-analysis-conducted-in-watson-et-al.-2019.-in-the-naive-model."><i class="fa fa-check"></i>PLACEHOLDER: Repeat the Black Smoke analysis conducted in Watson et al. 2019. in the “naive” model.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Disease.html"><a href="Disease.html"><i class="fa fa-check"></i><b>9</b> Disease-spatial patterns</a>
<ul>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#example-9.1-empirical-bayes-and-bayes-smoothing-of-copd-mortality-for-2010"><i class="fa fa-check"></i>Example 9.1: Empirical Bayes and Bayes smoothing of COPD mortality for 2010</a>
<ul>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#nimble-2"><i class="fa fa-check"></i>Nimble</a></li>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#stan-1"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#example-9.3-fitting-a-conditional-spatial-model-in-nimble-and-stan"><i class="fa fa-check"></i>Example 9.3: Fitting a conditional spatial model in <code>nimble</code> and <code>stan</code></a>
<ul>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#nimble-3"><i class="fa fa-check"></i>Nimble</a></li>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#stan-2"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#example-9.4-fitting-a-conditional-spatial-model-using-carbayes"><i class="fa fa-check"></i>Example 9.4: Fitting a conditional spatial model using CARBayes</a></li>
<li class="chapter" data-level="" data-path="Disease.html"><a href="Disease.html#example-9.5-fitting-a-conditional-model-using-inla"><i class="fa fa-check"></i>Example 9.5: Fitting a conditional model using INLA</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="hazards.html"><a href="hazards.html"><i class="fa fa-check"></i><b>10</b> Environmental hazards-spatial models</a>
<ul>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#example-10.1-spatial-patterns-in-lead-concentrations-in-the-soil-of-the-meuse-river-flood-plain"><i class="fa fa-check"></i>Example 10.1 Spatial patterns in lead concentrations in the soil of the Meuse River flood plain</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#example-10.2-examining-the-log-concentrations-of-lead-in-the-meuse-river-flood-plain"><i class="fa fa-check"></i>Example 10.2: Examining the log concentrations of lead in the Meuse River flood plain</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#example-10.3-mapping-the-locations-of-ozone-monitoring-sites-in-new-york-state"><i class="fa fa-check"></i>Example 10.3: Mapping the locations of ozone monitoring sites in New York State</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#example-10.6-spatial-prediction-of-temperatures-in-california"><i class="fa fa-check"></i>Example 10.6: Spatial prediction of temperatures in California</a></li>
<li class="chapter" data-level="10.1" data-path="hazards.html"><a href="hazards.html#example-10.8-spatial-prediction-of-no2-in-europe"><i class="fa fa-check"></i><b>10.1</b> Example 10.8 Spatial prediction of NO2 in Europe</a></li>
<li class="chapter" data-level="10.2" data-path="hazards.html"><a href="hazards.html#example-10.12-plotting-directional-variograms-for-temperatures-in-california"><i class="fa fa-check"></i><b>10.2</b> Example 10.12 Plotting directional variograms for temperatures in California</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#example-10.14-spatial-modeling-of-malaria-in-gambia"><i class="fa fa-check"></i>Example 10.14: Spatial modeling of malaria in Gambia</a>
<ul>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#nimble-4"><i class="fa fa-check"></i>Nimble</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#stan-3"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#supplementary-material-1"><i class="fa fa-check"></i>Supplementary Material</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#extra-10.1-spatial-patterns-of-benzene-concentrations-in-montreal-qc-canada"><i class="fa fa-check"></i>Extra 10.1: Spatial patterns of benzene concentrations in Montreal, QC, Canada</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#extra-10.2-examining-the-log-concentrations-of-benzene-in-montreal"><i class="fa fa-check"></i>Extra 10.2: Examining the log concentrations of benzene in Montreal</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#extra-10.5-variogram"><i class="fa fa-check"></i>Extra 10.5: Variogram</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#extra-10.6-basic-spatial-modelling-and-prediction-of-benzene-in-montreal"><i class="fa fa-check"></i>Extra 10.6 Basic spatial modelling and prediction of benzene in Montreal</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#extra-10.8-spatial-modelling-of-benzene-in-montreal"><i class="fa fa-check"></i>Extra 10.8 Spatial modelling of Benzene in Montreal</a>
<ul>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#nimble-5"><i class="fa fa-check"></i>Nimble</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#stan-4"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#extra-10.9-spatial-predictions"><i class="fa fa-check"></i>Extra 10.9: Spatial predictions</a>
<ul>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#nimble-6"><i class="fa fa-check"></i>Nimble</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#stan-5"><i class="fa fa-check"></i>Stan</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#extra-10.10-inla-creating-a-mesh"><i class="fa fa-check"></i>Extra 10.10: INLA, creating a mesh</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#extra-10.12-fitting-an-spde-model-using-rinla-benzene-concentration-in-montreal"><i class="fa fa-check"></i>Extra 10.12: Fitting an SPDE model using R–INLA: benzene concentration in Montreal</a></li>
<li class="chapter" data-level="" data-path="hazards.html"><a href="hazards.html#extra-10.13-directional-variograms"><i class="fa fa-check"></i>Extra 10.13: Directional variograms</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="Time.html"><a href="Time.html"><i class="fa fa-check"></i><b>11</b> Time-why it also matters</a>
<ul>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#example-11.1-ground-level-ozone-concentrations"><i class="fa fa-check"></i>Example 11.1 Ground level ozone concentrations</a></li>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#example-11.2-low-pass-filtering-of-carbon-monoxide-levels-using-the-moving-average"><i class="fa fa-check"></i>Example 11.2 Low-pass filtering of carbon monoxide levels using the moving average</a></li>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#example-11.13-forecasting-ozone-levels"><i class="fa fa-check"></i>Example 11.13 Forecasting ozone levels</a></li>
<li class="chapter" data-level="" data-path="Time.html"><a href="Time.html#example-11.14-forecasting-volcanic-ash"><i class="fa fa-check"></i>Example 11.14 Forecasting volcanic ash</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="exposure.html"><a href="exposure.html"><i class="fa fa-check"></i><b>12</b> Exposure assessment-over space and time</a>
<ul>
<li class="chapter" data-level="" data-path="exposure.html"><a href="exposure.html#example-idk-spatio-temporal-model-for-the-uk-ozone-data"><i class="fa fa-check"></i>Example IDK: Spatio-temporal model for the UK ozone data</a>
<ul>
<li class="chapter" data-level="" data-path="exposure.html"><a href="exposure.html#nimble-7"><i class="fa fa-check"></i>Nimble</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="causality.html"><a href="causality.html"><i class="fa fa-check"></i><b>13</b> Causality-roadblocks on the way to it</a>
<ul>
<li class="chapter" data-level="" data-path="causality.html"><a href="causality.html#solutions-to-selected-exercises-1"><i class="fa fa-check"></i>Solutions to Selected Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="causality.html"><a href="causality.html#question-13.16-load-the-italy-and-china-data-described-in-example-13.3-and-included-in-the-supplementary-bookdown-material-into-r."><i class="fa fa-check"></i>Question 13.16: Load the Italy and China data, described in Example 13.3, and included in the supplementary Bookdown material into R.</a></li>
<li class="chapter" data-level="" data-path="causality.html"><a href="causality.html#question-13.17-using-the-italy-and-china-data-stratified-by-the-age-groups-70-and-geq-70-obtain-empirical-estimates-of-p_1-and-p_2-as-defined-in-an-sdis.-in-the-following-questions-assume-that-p_1-and-p_2-are-the-population-values."><i class="fa fa-check"></i>Question 13.17: Using the Italy and China data stratified by the age groups <span class="math inline">\(&lt;70\)</span> and <span class="math inline">\(\geq 70\)</span>, obtain empirical estimates of <span class="math inline">\(P_1\)</span> and <span class="math inline">\(P_2\)</span>, as defined in an SDis. In the following questions, assume that <span class="math inline">\(P_1\)</span> and <span class="math inline">\(P_2\)</span> are the population values.</a></li>
<li class="chapter" data-level="" data-path="causality.html"><a href="causality.html#question-13.18-stratify-the-italy-and-china-data-by-the-age-groups-50-and-geq-50.-display-the-corresponding-contingency-tables."><i class="fa fa-check"></i>Question 13.18: Stratify the Italy and China data by the age groups <span class="math inline">\(&lt;50\)</span> and <span class="math inline">\(\geq 50\)</span>. Display the corresponding contingency tables.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="monitoring.html"><a href="monitoring.html"><i class="fa fa-check"></i><b>14</b> Better monitoring network design-getting better measurements</a></li>
<li class="chapter" data-level="15" data-path="frontiers.html"><a href="frontiers.html"><i class="fa fa-check"></i><b>15</b> Current frontiers</a></li>
<li class="chapter" data-level="" data-path="course.html"><a href="course.html"><i class="fa fa-check"></i>Course</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatio-Temporal Methods in Environmental Epidemiology with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Strategies" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Strategies implementing uncertainty models<a href="Strategies.html#Strategies" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter considers both some of the wider issues related to modelling and the generalisability of results and more
technical material on the effect of covariates and model selection. From this chapter, the reader will have gained an
understanding of the following topics:</p>
<ul>
<li>Why having contrasts in the variables of interest is important in assessing the effects they have on the response
variable.</li>
<li>The biases that may arise in the presence of covariates and how covariates can affect variable selection and model
choice.</li>
<li>Hierarchical models and how that can be used to acknowledge dependence between observations.</li>
<li>There are issues with using p–values as measures of evidence against a null hypothesis. Basing scientific conclusions
on it can lead to non-reproducible results.</li>
<li>The use of predictions from exposure models including acknowledging the additional uncertainty involved when
using predictions as inputs to a health model.</li>
<li>Methods for performing model selection, including the pros and cons of automatic selection procedures.</li>
<li>Model selection within the Bayesian setting and how the models themselves can be incorporated into the estimation
process using Bayesian Model Averaging.</li>
</ul>
<div id="example-7.6-model-choice-in-studies-of-air-pollution-and-health" class="section level2 unnumbered hasAnchor">
<h2>Example 7.6 Model choice in studies of air pollution and health<a href="Strategies.html#example-7.6-model-choice-in-studies-of-air-pollution-and-health" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="Strategies.html#cb63-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb63-2"><a href="Strategies.html#cb63-2" tabindex="-1"></a><span class="fu">library</span>(geoR)</span>
<span id="cb63-3"><a href="Strategies.html#cb63-3" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb63-4"><a href="Strategies.html#cb63-4" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb63-5"><a href="Strategies.html#cb63-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb63-6"><a href="Strategies.html#cb63-6" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb63-7"><a href="Strategies.html#cb63-7" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb63-8"><a href="Strategies.html#cb63-8" tabindex="-1"></a><span class="fu">library</span>(nimble)</span>
<span id="cb63-9"><a href="Strategies.html#cb63-9" tabindex="-1"></a><span class="co"># Load data on benzene concentration in Montreal</span></span>
<span id="cb63-10"><a href="Strategies.html#cb63-10" tabindex="-1"></a>ethylbenzene <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/montreal_ethylbenzene.csv&quot;</span>)</span>
<span id="cb63-11"><a href="Strategies.html#cb63-11" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Add description of the data, this is the April campaign</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="Strategies.html#cb64-1" tabindex="-1"></a><span class="co"># create a new variable in &quot;sp&quot; format and define coordinates</span></span>
<span id="cb64-2"><a href="Strategies.html#cb64-2" tabindex="-1"></a>ethylbenzene_geo <span class="ot">&lt;-</span> ethylbenzene</span>
<span id="cb64-3"><a href="Strategies.html#cb64-3" tabindex="-1"></a><span class="fu">coordinates</span>(ethylbenzene_geo) <span class="ot">&lt;-</span> <span class="er">~</span> lon <span class="sc">+</span> lat</span>
<span id="cb64-4"><a href="Strategies.html#cb64-4" tabindex="-1"></a><span class="fu">proj4string</span>(ethylbenzene_geo) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84&quot;</span>)</span>
<span id="cb64-5"><a href="Strategies.html#cb64-5" tabindex="-1"></a><span class="co"># specify the bounding box</span></span>
<span id="cb64-6"><a href="Strategies.html#cb64-6" tabindex="-1"></a>latLongBox <span class="ot">=</span> <span class="fu">bbox</span>(ethylbenzene_geo)</span>
<span id="cb64-7"><a href="Strategies.html#cb64-7" tabindex="-1"></a>location <span class="ot">=</span> <span class="fu">c</span>(latLongBox[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.05</span>,</span>
<span id="cb64-8"><a href="Strategies.html#cb64-8" tabindex="-1"></a>             latLongBox[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.05</span>,</span>
<span id="cb64-9"><a href="Strategies.html#cb64-9" tabindex="-1"></a>             latLongBox[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.1</span>,</span>
<span id="cb64-10"><a href="Strategies.html#cb64-10" tabindex="-1"></a>             latLongBox[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.05</span>)</span>
<span id="cb64-11"><a href="Strategies.html#cb64-11" tabindex="-1"></a><span class="co"># create map with location dots marked on it in</span></span>
<span id="cb64-12"><a href="Strategies.html#cb64-12" tabindex="-1"></a>MontrelEthylbenzeneMap <span class="ot">&lt;-</span></span>
<span id="cb64-13"><a href="Strategies.html#cb64-13" tabindex="-1"></a>  <span class="fu">get_stamenmap</span>(<span class="at">bbox =</span>  location,</span>
<span id="cb64-14"><a href="Strategies.html#cb64-14" tabindex="-1"></a>                <span class="at">zoom =</span> <span class="dv">10</span>)</span>
<span id="cb64-15"><a href="Strategies.html#cb64-15" tabindex="-1"></a><span class="fu">ggmap</span>(MontrelEthylbenzeneMap) <span class="sc">+</span> <span class="fu">geom_point</span>(</span>
<span id="cb64-16"><a href="Strategies.html#cb64-16" tabindex="-1"></a>  <span class="at">data =</span> ethylbenzene,</span>
<span id="cb64-17"><a href="Strategies.html#cb64-17" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> lon,</span>
<span id="cb64-18"><a href="Strategies.html#cb64-18" tabindex="-1"></a>      <span class="at">y =</span> lat,</span>
<span id="cb64-19"><a href="Strategies.html#cb64-19" tabindex="-1"></a>      <span class="at">size =</span> <span class="fu">log</span>(Ethylbenzene)),</span>
<span id="cb64-20"><a href="Strategies.html#cb64-20" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#011f4b&quot;</span>,</span>
<span id="cb64-21"><a href="Strategies.html#cb64-21" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.45</span></span>
<span id="cb64-22"><a href="Strategies.html#cb64-22" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/Example%207.6%20map%20data-1.png" width="672" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="Strategies.html#cb65-1" tabindex="-1"></a>lur <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/VOC_predictors.csv&quot;</span>)</span>
<span id="cb65-2"><a href="Strategies.html#cb65-2" tabindex="-1"></a><span class="fu">colnames</span>(lur)</span></code></pre></div>
<pre><code>##  [1] &quot;X&quot;                                  &quot;Y&quot;                                 
##  [3] &quot;ID&quot;                                 &quot;Building_100m&quot;                     
##  [5] &quot;Government.and.Institutional_1000m&quot; &quot;Residential_1000m&quot;                 
##  [7] &quot;Pop_1000m&quot;                          &quot;Roads_1000m&quot;                       
##  [9] &quot;Tot_NOx_1000m&quot;                      &quot;Ethylbenzene&quot;</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="Strategies.html#cb67-1" tabindex="-1"></a>lur<span class="sc">$</span>X <span class="ot">&lt;-</span> lur<span class="sc">$</span>X<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb67-2"><a href="Strategies.html#cb67-2" tabindex="-1"></a>lur<span class="sc">$</span>Y <span class="ot">&lt;-</span> lur<span class="sc">$</span>Y<span class="sc">/</span><span class="dv">1000</span></span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="Strategies.html#cb68-1" tabindex="-1"></a><span class="fu">ggpairs</span>(lur[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)], <span class="at">title=</span><span class="st">&quot;correlogram with ggpairs()&quot;</span>, <span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20join%20covariates%20and%20data-1.png" width="672" />
Since Average and Total traffic are highly correlated, as well as Average and Total NOx, we will just use one of them.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="Strategies.html#cb69-1" tabindex="-1"></a>lur_ethyl <span class="ot">&lt;-</span> lur <span class="sc">|&gt;</span> <span class="fu">select</span>( <span class="fu">ends_with</span>(<span class="st">&quot;0m&quot;</span>), <span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>,<span class="st">&quot;Ethylbenzene&quot;</span>)</span>
<span id="cb69-2"><a href="Strategies.html#cb69-2" tabindex="-1"></a></span>
<span id="cb69-3"><a href="Strategies.html#cb69-3" tabindex="-1"></a><span class="co"># Fit a glm</span></span>
<span id="cb69-4"><a href="Strategies.html#cb69-4" tabindex="-1"></a></span>
<span id="cb69-5"><a href="Strategies.html#cb69-5" tabindex="-1"></a><span class="fu">glm</span>(</span>
<span id="cb69-6"><a href="Strategies.html#cb69-6" tabindex="-1"></a>  <span class="fu">log</span>(Ethylbenzene) <span class="sc">~</span> X <span class="sc">+</span> Y  <span class="sc">+</span></span>
<span id="cb69-7"><a href="Strategies.html#cb69-7" tabindex="-1"></a>    Building_100m <span class="sc">+</span>  Government.and.Institutional_1000m <span class="sc">+</span> Residential_1000m <span class="sc">+</span> </span>
<span id="cb69-8"><a href="Strategies.html#cb69-8" tabindex="-1"></a>    Pop_1000m <span class="sc">+</span> Roads_1000m, <span class="at">data =</span> lur_ethyl )</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = log(Ethylbenzene) ~ X + Y + Building_100m + Government.and.Institutional_1000m + 
##     Residential_1000m + Pop_1000m + Roads_1000m, data = lur_ethyl)
## 
## Coefficients:
##                        (Intercept)                                   X  
##                          1.459e+01                          -8.194e-03  
##                                  Y                       Building_100m  
##                         -1.788e-03                           1.311e-05  
## Government.and.Institutional_1000m                   Residential_1000m  
##                          2.408e-08                          -4.021e-08  
##                          Pop_1000m                         Roads_1000m  
##                          1.174e-05                           3.355e-06  
## 
## Degrees of Freedom: 99 Total (i.e. Null);  92 Residual
## Null Deviance:       8.407 
## Residual Deviance: 6.714     AIC: 31.7</code></pre>
<div id="nimble-1" class="section level3 unnumbered hasAnchor">
<h3>Nimble<a href="Strategies.html#nimble-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lasso regression</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="Strategies.html#cb71-1" tabindex="-1"></a>Ex7_6LassoCode <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb71-2"><a href="Strategies.html#cb71-2" tabindex="-1"></a>  <span class="co"># Likelihood</span></span>
<span id="cb71-3"><a href="Strategies.html#cb71-3" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb71-4"><a href="Strategies.html#cb71-4" tabindex="-1"></a>    y[i]   <span class="sc">~</span> <span class="fu">dnorm</span>(mu[i], <span class="at">sd =</span> sigma)</span>
<span id="cb71-5"><a href="Strategies.html#cb71-5" tabindex="-1"></a>    mu[i] <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> <span class="fu">inprod</span>(X[i, ], beta[<span class="dv">1</span><span class="sc">:</span>p])</span>
<span id="cb71-6"><a href="Strategies.html#cb71-6" tabindex="-1"></a>  }</span>
<span id="cb71-7"><a href="Strategies.html#cb71-7" tabindex="-1"></a>  </span>
<span id="cb71-8"><a href="Strategies.html#cb71-8" tabindex="-1"></a>  <span class="co"># Prior specification</span></span>
<span id="cb71-9"><a href="Strategies.html#cb71-9" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) {</span>
<span id="cb71-10"><a href="Strategies.html#cb71-10" tabindex="-1"></a>    beta[j] <span class="sc">~</span> <span class="fu">ddexp</span>(<span class="dv">0</span>, <span class="at">scale =</span> taub <span class="sc">*</span> taue)</span>
<span id="cb71-11"><a href="Strategies.html#cb71-11" tabindex="-1"></a>  }</span>
<span id="cb71-12"><a href="Strategies.html#cb71-12" tabindex="-1"></a>  </span>
<span id="cb71-13"><a href="Strategies.html#cb71-13" tabindex="-1"></a>  taue  <span class="sc">~</span>  <span class="fu">dgamma</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb71-14"><a href="Strategies.html#cb71-14" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>taue</span>
<span id="cb71-15"><a href="Strategies.html#cb71-15" tabindex="-1"></a>  taub  <span class="sc">~</span>  <span class="fu">dgamma</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb71-16"><a href="Strategies.html#cb71-16" tabindex="-1"></a>  beta0  <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.01</span>)</span>
<span id="cb71-17"><a href="Strategies.html#cb71-17" tabindex="-1"></a></span>
<span id="cb71-18"><a href="Strategies.html#cb71-18" tabindex="-1"></a>})</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="Strategies.html#cb72-1" tabindex="-1"></a>X <span class="ot">&lt;-</span>  lur_ethyl <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>( <span class="fu">ends_with</span>(<span class="st">&quot;0m&quot;</span>), <span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb72-2"><a href="Strategies.html#cb72-2" tabindex="-1"></a></span>
<span id="cb72-3"><a href="Strategies.html#cb72-3" tabindex="-1"></a>constants <span class="ot">&lt;-</span></span>
<span id="cb72-4"><a href="Strategies.html#cb72-4" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">nrow</span>(lur_ethyl), <span class="at">p =</span> <span class="fu">ncol</span>(X))</span>
<span id="cb72-5"><a href="Strategies.html#cb72-5" tabindex="-1"></a></span>
<span id="cb72-6"><a href="Strategies.html#cb72-6" tabindex="-1"></a>ex.data <span class="ot">&lt;-</span></span>
<span id="cb72-7"><a href="Strategies.html#cb72-7" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">y =</span> <span class="fu">log</span>(lur_ethyl<span class="sc">$</span>Ethylbenzene),</span>
<span id="cb72-8"><a href="Strategies.html#cb72-8" tabindex="-1"></a>       <span class="at">X =</span> <span class="fu">scale</span>(X))</span>
<span id="cb72-9"><a href="Strategies.html#cb72-9" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&quot;beta0&quot;</span>,  <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;taub&quot;</span>,<span class="st">&quot;taue&quot;</span>, <span class="st">&quot;sigma&quot;</span>)</span>
<span id="cb72-10"><a href="Strategies.html#cb72-10" tabindex="-1"></a></span>
<span id="cb72-11"><a href="Strategies.html#cb72-11" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">sigma =</span> <span class="fl">0.1</span>, <span class="at">tau =</span> <span class="fl">0.1</span>)</span>
<span id="cb72-12"><a href="Strategies.html#cb72-12" tabindex="-1"></a><span class="co"># Run model in nimble</span></span>
<span id="cb72-13"><a href="Strategies.html#cb72-13" tabindex="-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb72-14"><a href="Strategies.html#cb72-14" tabindex="-1"></a></span>
<span id="cb72-15"><a href="Strategies.html#cb72-15" tabindex="-1"></a>mcmc.out <span class="ot">&lt;-</span> <span class="fu">nimbleMCMC</span>(</span>
<span id="cb72-16"><a href="Strategies.html#cb72-16" tabindex="-1"></a>  <span class="at">code =</span> Ex7_6LassoCode,</span>
<span id="cb72-17"><a href="Strategies.html#cb72-17" tabindex="-1"></a>  <span class="at">constants =</span> constants,</span>
<span id="cb72-18"><a href="Strategies.html#cb72-18" tabindex="-1"></a>  <span class="at">data =</span> ex.data,</span>
<span id="cb72-19"><a href="Strategies.html#cb72-19" tabindex="-1"></a>  <span class="at">inits =</span> inits,</span>
<span id="cb72-20"><a href="Strategies.html#cb72-20" tabindex="-1"></a>  <span class="at">monitors =</span> params,</span>
<span id="cb72-21"><a href="Strategies.html#cb72-21" tabindex="-1"></a>  <span class="at">niter =</span> <span class="dv">100000</span>,</span>
<span id="cb72-22"><a href="Strategies.html#cb72-22" tabindex="-1"></a>  <span class="at">nburnin =</span> <span class="dv">50000</span>,</span>
<span id="cb72-23"><a href="Strategies.html#cb72-23" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">15</span>,</span>
<span id="cb72-24"><a href="Strategies.html#cb72-24" tabindex="-1"></a>  <span class="at">WAIC =</span> <span class="cn">TRUE</span>,</span>
<span id="cb72-25"><a href="Strategies.html#cb72-25" tabindex="-1"></a>  <span class="at">nchains =</span> <span class="dv">2</span>,</span>
<span id="cb72-26"><a href="Strategies.html#cb72-26" tabindex="-1"></a>  <span class="at">summary =</span> <span class="cn">TRUE</span>,</span>
<span id="cb72-27"><a href="Strategies.html#cb72-27" tabindex="-1"></a>  <span class="at">samplesAsCodaMCMC =</span> <span class="cn">TRUE</span></span>
<span id="cb72-28"><a href="Strategies.html#cb72-28" tabindex="-1"></a>)</span>
<span id="cb72-29"><a href="Strategies.html#cb72-29" tabindex="-1"></a>end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb72-30"><a href="Strategies.html#cb72-30" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb72-31"><a href="Strategies.html#cb72-31" tabindex="-1"></a>run_time</span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="Strategies.html#cb73-1" tabindex="-1"></a><span class="fu">min</span>(coda<span class="sc">::</span><span class="fu">effectiveSize</span>(mcmc.out<span class="sc">$</span>samples))</span></code></pre></div>
<pre><code>## [1] 1800.881</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="Strategies.html#cb75-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta0&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta0&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-1.png" width="672" /></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="Strategies.html#cb76-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[1]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta1&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-2.png" width="672" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="Strategies.html#cb77-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[2]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta2&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-3.png" width="672" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="Strategies.html#cb78-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[3]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta3&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-4.png" width="672" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="Strategies.html#cb79-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[4]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta4&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-5.png" width="672" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="Strategies.html#cb80-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[5]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta5&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-6.png" width="672" /></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="Strategies.html#cb81-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[6]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta6&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-7.png" width="672" /></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="Strategies.html#cb82-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[7]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta7&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-8.png" width="672" /></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="Strategies.html#cb83-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[8]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta8&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-9.png" width="672" /></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="Strategies.html#cb84-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;sigma&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-10.png" width="672" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="Strategies.html#cb85-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;taue&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;taue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-11.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="Strategies.html#cb86-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;taub&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;taub&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20lasso%20traceplot-12.png" width="672" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="Strategies.html#cb87-1" tabindex="-1"></a>beta_var  <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;beta[&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(X), <span class="st">&quot;]&quot;</span>) </span>
<span id="cb87-2"><a href="Strategies.html#cb87-2" tabindex="-1"></a>post_summary <span class="ot">&lt;-</span> mcmc.out<span class="sc">$</span>summary<span class="sc">$</span>all.chains <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>() </span>
<span id="cb87-3"><a href="Strategies.html#cb87-3" tabindex="-1"></a>post_summary <span class="ot">&lt;-</span> post_summary[beta_var,]</span>
<span id="cb87-4"><a href="Strategies.html#cb87-4" tabindex="-1"></a></span>
<span id="cb87-5"><a href="Strategies.html#cb87-5" tabindex="-1"></a>post_summary<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">colnames</span>(X)</span>
<span id="cb87-6"><a href="Strategies.html#cb87-6" tabindex="-1"></a></span>
<span id="cb87-7"><a href="Strategies.html#cb87-7" tabindex="-1"></a><span class="fu">ggplot</span>(post_summary,</span>
<span id="cb87-8"><a href="Strategies.html#cb87-8" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> variable)) <span class="sc">+</span> </span>
<span id="cb87-9"><a href="Strategies.html#cb87-9" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">y =</span> Mean, <span class="at">ymin =</span><span class="st">`</span><span class="at">95%CI_low</span><span class="st">`</span>, <span class="at">ymax =</span><span class="st">`</span><span class="at">95%CI_upp</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb87-10"><a href="Strategies.html#cb87-10" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb87-11"><a href="Strategies.html#cb87-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207_6%20nimble%20lasso%20posterior%20summary-1.png" width="672" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="Strategies.html#cb88-1" tabindex="-1"></a>Ex7_6HorseshoeCode <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb88-2"><a href="Strategies.html#cb88-2" tabindex="-1"></a></span>
<span id="cb88-3"><a href="Strategies.html#cb88-3" tabindex="-1"></a>  <span class="co"># Likelihood</span></span>
<span id="cb88-4"><a href="Strategies.html#cb88-4" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb88-5"><a href="Strategies.html#cb88-5" tabindex="-1"></a>    y[i]   <span class="sc">~</span> <span class="fu">dnorm</span>(mu[i], <span class="at">sd =</span> sigma)</span>
<span id="cb88-6"><a href="Strategies.html#cb88-6" tabindex="-1"></a>    mu[i] <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> <span class="fu">inprod</span>(X[i,], beta[<span class="dv">1</span><span class="sc">:</span>p])</span>
<span id="cb88-7"><a href="Strategies.html#cb88-7" tabindex="-1"></a>  }</span>
<span id="cb88-8"><a href="Strategies.html#cb88-8" tabindex="-1"></a></span>
<span id="cb88-9"><a href="Strategies.html#cb88-9" tabindex="-1"></a>  <span class="co"># Prior specification</span></span>
<span id="cb88-10"><a href="Strategies.html#cb88-10" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p){</span>
<span id="cb88-11"><a href="Strategies.html#cb88-11" tabindex="-1"></a>    beta[j] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="at">var =</span> lambda)</span>
<span id="cb88-12"><a href="Strategies.html#cb88-12" tabindex="-1"></a>  }</span>
<span id="cb88-13"><a href="Strategies.html#cb88-13" tabindex="-1"></a>  lambda <span class="sc">~</span> <span class="fu">T</span>(<span class="fu">dt</span>(<span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> tau, <span class="at">df =</span> <span class="dv">1</span>), <span class="dv">0</span>, <span class="cn">Inf</span>)</span>
<span id="cb88-14"><a href="Strategies.html#cb88-14" tabindex="-1"></a>  tau  <span class="sc">~</span> <span class="fu">T</span>(<span class="fu">dt</span>(<span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> nu, <span class="at">df =</span> <span class="dv">1</span>), <span class="dv">0</span>, <span class="cn">Inf</span>)</span>
<span id="cb88-15"><a href="Strategies.html#cb88-15" tabindex="-1"></a>  nu <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(nu2)</span>
<span id="cb88-16"><a href="Strategies.html#cb88-16" tabindex="-1"></a>  nu2 <span class="sc">~</span>  <span class="fu">dgamma</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)</span>
<span id="cb88-17"><a href="Strategies.html#cb88-17" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">T</span>(<span class="fu">dt</span>(<span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">df =</span> <span class="dv">1</span>), <span class="dv">0</span>, <span class="cn">Inf</span>)</span>
<span id="cb88-18"><a href="Strategies.html#cb88-18" tabindex="-1"></a>  beta0  <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="fl">0.01</span>)</span>
<span id="cb88-19"><a href="Strategies.html#cb88-19" tabindex="-1"></a></span>
<span id="cb88-20"><a href="Strategies.html#cb88-20" tabindex="-1"></a>})</span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="Strategies.html#cb89-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb89-2"><a href="Strategies.html#cb89-2" tabindex="-1"></a></span>
<span id="cb89-3"><a href="Strategies.html#cb89-3" tabindex="-1"></a>constants <span class="ot">&lt;-</span></span>
<span id="cb89-4"><a href="Strategies.html#cb89-4" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">nrow</span>(lur_ethyl), <span class="at">p =</span> <span class="fu">ncol</span>(X))</span>
<span id="cb89-5"><a href="Strategies.html#cb89-5" tabindex="-1"></a></span>
<span id="cb89-6"><a href="Strategies.html#cb89-6" tabindex="-1"></a>ex.data <span class="ot">&lt;-</span></span>
<span id="cb89-7"><a href="Strategies.html#cb89-7" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">y =</span> <span class="fu">log</span>(lur_ethyl<span class="sc">$</span>Ethylbenzene),</span>
<span id="cb89-8"><a href="Strategies.html#cb89-8" tabindex="-1"></a>       <span class="at">X =</span> <span class="fu">scale</span>(X))</span>
<span id="cb89-9"><a href="Strategies.html#cb89-9" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">&quot;beta0&quot;</span>,  <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;tau&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;lambda&quot;</span>, <span class="st">&quot;nu&quot;</span>)</span>
<span id="cb89-10"><a href="Strategies.html#cb89-10" tabindex="-1"></a></span>
<span id="cb89-11"><a href="Strategies.html#cb89-11" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="at">sigma =</span> <span class="fl">0.1</span>, <span class="at">tau =</span> <span class="fl">0.1</span>)</span>
<span id="cb89-12"><a href="Strategies.html#cb89-12" tabindex="-1"></a><span class="co"># Run model in nimble</span></span>
<span id="cb89-13"><a href="Strategies.html#cb89-13" tabindex="-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb89-14"><a href="Strategies.html#cb89-14" tabindex="-1"></a></span>
<span id="cb89-15"><a href="Strategies.html#cb89-15" tabindex="-1"></a>mcmc.out <span class="ot">&lt;-</span> <span class="fu">nimbleMCMC</span>(</span>
<span id="cb89-16"><a href="Strategies.html#cb89-16" tabindex="-1"></a>  <span class="at">code =</span> Ex7_6HorseshoeCode,</span>
<span id="cb89-17"><a href="Strategies.html#cb89-17" tabindex="-1"></a>  <span class="at">constants =</span> constants,</span>
<span id="cb89-18"><a href="Strategies.html#cb89-18" tabindex="-1"></a>  <span class="at">data =</span> ex.data,</span>
<span id="cb89-19"><a href="Strategies.html#cb89-19" tabindex="-1"></a>  <span class="at">inits =</span> inits,</span>
<span id="cb89-20"><a href="Strategies.html#cb89-20" tabindex="-1"></a>  <span class="at">monitors =</span> params,</span>
<span id="cb89-21"><a href="Strategies.html#cb89-21" tabindex="-1"></a>  <span class="at">niter =</span> <span class="dv">100000</span>,</span>
<span id="cb89-22"><a href="Strategies.html#cb89-22" tabindex="-1"></a>  <span class="at">nburnin =</span> <span class="dv">50000</span>,</span>
<span id="cb89-23"><a href="Strategies.html#cb89-23" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">15</span>,</span>
<span id="cb89-24"><a href="Strategies.html#cb89-24" tabindex="-1"></a>  <span class="at">WAIC =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-25"><a href="Strategies.html#cb89-25" tabindex="-1"></a>  <span class="at">nchains =</span> <span class="dv">2</span>,</span>
<span id="cb89-26"><a href="Strategies.html#cb89-26" tabindex="-1"></a>  <span class="at">summary =</span> <span class="cn">TRUE</span>,</span>
<span id="cb89-27"><a href="Strategies.html#cb89-27" tabindex="-1"></a>  <span class="at">samplesAsCodaMCMC =</span> <span class="cn">TRUE</span></span>
<span id="cb89-28"><a href="Strategies.html#cb89-28" tabindex="-1"></a>)</span>
<span id="cb89-29"><a href="Strategies.html#cb89-29" tabindex="-1"></a>end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb89-30"><a href="Strategies.html#cb89-30" tabindex="-1"></a>run_time <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb89-31"><a href="Strategies.html#cb89-31" tabindex="-1"></a>run_time</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="Strategies.html#cb90-1" tabindex="-1"></a><span class="fu">min</span>(coda<span class="sc">::</span><span class="fu">effectiveSize</span>(mcmc.out<span class="sc">$</span>samples))</span></code></pre></div>
<pre><code>## [1] 176.8927</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="Strategies.html#cb92-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta0&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta0&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-1.png" width="672" /></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="Strategies.html#cb93-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[1]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta1&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-2.png" width="672" /></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="Strategies.html#cb94-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[2]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta2&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-3.png" width="672" /></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="Strategies.html#cb95-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[3]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta3&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-4.png" width="672" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="Strategies.html#cb96-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[4]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta4&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-5.png" width="672" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="Strategies.html#cb97-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[5]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta5&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-6.png" width="672" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="Strategies.html#cb98-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[6]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta6&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-7.png" width="672" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="Strategies.html#cb99-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[7]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta7&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-8.png" width="672" /></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="Strategies.html#cb100-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;beta[8]&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;beta8&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-9.png" width="672" /></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="Strategies.html#cb101-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;sigma&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-10.png" width="672" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="Strategies.html#cb102-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;tau&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;tau&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-11.png" width="672" /></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="Strategies.html#cb103-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;lambda&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;lambda&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-12.png" width="672" /></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="Strategies.html#cb104-1" tabindex="-1"></a><span class="fu">plot</span>(mcmc.out<span class="sc">$</span>samples[, <span class="fu">c</span>(<span class="st">&quot;nu&quot;</span>)], <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;nu&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207.6%20nimble%20horseshoe%20traceplot-13.png" width="672" /></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="Strategies.html#cb105-1" tabindex="-1"></a>beta_var  <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;beta[&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(X), <span class="st">&quot;]&quot;</span>) </span>
<span id="cb105-2"><a href="Strategies.html#cb105-2" tabindex="-1"></a>post_summary <span class="ot">&lt;-</span> mcmc.out<span class="sc">$</span>summary<span class="sc">$</span>all.chains <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>() </span>
<span id="cb105-3"><a href="Strategies.html#cb105-3" tabindex="-1"></a>post_summary <span class="ot">&lt;-</span> post_summary[beta_var,]</span>
<span id="cb105-4"><a href="Strategies.html#cb105-4" tabindex="-1"></a></span>
<span id="cb105-5"><a href="Strategies.html#cb105-5" tabindex="-1"></a>post_summary<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">colnames</span>(X)</span>
<span id="cb105-6"><a href="Strategies.html#cb105-6" tabindex="-1"></a></span>
<span id="cb105-7"><a href="Strategies.html#cb105-7" tabindex="-1"></a><span class="fu">ggplot</span>(post_summary,</span>
<span id="cb105-8"><a href="Strategies.html#cb105-8" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> variable)) <span class="sc">+</span> </span>
<span id="cb105-9"><a href="Strategies.html#cb105-9" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">y =</span> Mean, <span class="at">ymin =</span><span class="st">`</span><span class="at">95%CI_low</span><span class="st">`</span>, <span class="at">ymax =</span><span class="st">`</span><span class="at">95%CI_upp</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb105-10"><a href="Strategies.html#cb105-10" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb105-11"><a href="Strategies.html#cb105-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/Ex%207_6%20nimble%20horseshoe%20posterior%20summary-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tactics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="trusted.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/07-Chpt7.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
